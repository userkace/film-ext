var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,r,s,a,n){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof o[a]&&o[a],l=i.cache||{},u="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(e,r){if(!l[e]){if(!t[e]){var s="function"==typeof o[a]&&o[a];if(!r&&s)return s(e,!0);if(i)return i(e,!0);if(u&&"string"==typeof e)return u(e);var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}d.resolve=function(r){var s=t[e][1][r];return null!=s?s:r},d.cache={};var h=l[e]=new c.Module(e);t[e][0].call(h.exports,d,h,h.exports,this)}return l[e].exports;function d(e){var t=d.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=l,c.parent=i,c.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]},Object.defineProperty(c,"root",{get:function(){return o[a]}}),o[a]=c;for(var h=0;h<r.length;h++)c(r[h]);if(s){var d=c(s);"object"==typeof exports&&"undefined"!=typeof module?module.exports=d:"function"==typeof e&&e.amd?e(function(){return d}):n&&(this[n]=d)}}({kgW6q:[function(e,t,r){e("./messaging"),e("../../../src/background")},{"./messaging":"iG3ww","../../../src/background":"fx8Od"}],iG3ww:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js"),a=e("~background/messages/hello"),n=s.interopDefault(a),o=e("~background/messages/makeRequest"),i=s.interopDefault(o),l=e("~background/messages/openPage"),u=s.interopDefault(l),c=e("~background/messages/prepareStream"),h=s.interopDefault(c);globalThis.__plasmoInternalPortMap=new Map,chrome.runtime.onMessageExternal.addListener((e,t,r)=>{switch(e.name){case"hello":(0,n.default)({sender:t,...e},{send:e=>r(e)});break;case"makeRequest":(0,i.default)({sender:t,...e},{send:e=>r(e)});break;case"openPage":(0,u.default)({sender:t,...e},{send:e=>r(e)});break;case"prepareStream":(0,h.default)({sender:t,...e},{send:e=>r(e)})}return!0}),chrome.runtime.onMessage.addListener((e,t,r)=>{switch(e.name){case"hello":(0,n.default)({sender:t,...e},{send:e=>r(e)});break;case"makeRequest":(0,i.default)({sender:t,...e},{send:e=>r(e)});break;case"openPage":(0,u.default)({sender:t,...e},{send:e=>r(e)});break;case"prepareStream":(0,h.default)({sender:t,...e},{send:e=>r(e)})}return!0}),chrome.runtime.onConnect.addListener(function(e){globalThis.__plasmoInternalPortMap.set(e.name,e),e.onMessage.addListener(function(t){e.name})})},{"~background/messages/hello":"gRrzt","~background/messages/makeRequest":"fZ9h9","~background/messages/openPage":"ZIxra","~background/messages/prepareStream":"amvG0","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],gRrzt:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var s=e("~hooks/usePermission"),a=e("~hooks/useVersion"),n=e("~utils/storage");let o=async(e,t)=>{try{if(!e.sender?.tab?.url)throw Error("No tab URL found in the request.");let r=(0,a.getVersion)();t.send({success:!0,version:r,allowed:await (0,n.isDomainWhitelisted)(e.sender.tab.url),hasPermission:await (0,s.hasPermission)()})}catch(e){t.send({success:!1,error:e instanceof Error?e.message:String(e)})}};r.default=o},{"~hooks/usePermission":"aUAKP","~hooks/useVersion":"cbs6b","~utils/storage":"gy7md","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],aUAKP:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"hasPermission",()=>o),s.export(r,"usePermission",()=>i);var a=e("react"),n=e("./useDomainWhitelist");async function o(){return chrome.permissions.contains({origins:["<all_urls>"]})}function i(){let{addDomain:e}=(0,n.useDomainWhitelist)(),[t,r]=(0,a.useState)(!1),s=(0,a.useCallback)(async t=>{let s=await chrome.permissions.request({origins:["<all_urls>"]});return r(s),s&&t&&e(t),s},[]);return(0,a.useEffect)(()=>{o().then(e=>r(e))},[]),{hasPermission:t,grantPermission:s}}},{react:"34kvN","./useDomainWhitelist":"cv0GT","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"34kvN":[function(e,t,r){t.exports=e("ae0ab14aecd941d7")},{ae0ab14aecd941d7:"eNFzo"}],eNFzo:[function(e,t,r){var s=Symbol.for("react.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function w(){}function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=b.prototype;var S=v.prototype=new w;S.constructor=v,y(S,b.prototype),S.isPureReactComponent=!0;var j=Array.isArray,R=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var a,n={},o=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(o=""+t.key),t)R.call(t,a)&&!E.hasOwnProperty(a)&&(n[a]=t[a]);var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];n.children=u}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===n[a]&&(n[a]=l[a]);return{$$typeof:s,type:e,key:o,ref:i,props:n,_owner:k.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===s}var C=/\/+/g;function O(e,t){var r,s;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,s={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return s[e]})):t.toString(36)}function _(e,t,r){if(null==e)return e;var n=[],o=0;return function e(t,r,n,o,i){var l,u,c,h=typeof t;("undefined"===h||"boolean"===h)&&(t=null);var d=!1;if(null===t)d=!0;else switch(h){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case s:case a:d=!0}}if(d)return i=i(d=t),t=""===o?"."+O(d,0):o,j(i)?(n="",null!=t&&(n=t.replace(C,"$&/")+"/"),e(i,r,n,"",function(e){return e})):null!=i&&(A(i)&&(l=i,u=n+(!i.key||d&&d.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+t,i={$$typeof:s,type:l.type,key:u,ref:l.ref,props:l.props,_owner:l._owner}),r.push(i)),1;if(d=0,o=""===o?".":o+":",j(t))for(var p=0;p<t.length;p++){var m=o+O(h=t[p],p);d+=e(h,r,n,m,i)}else if("function"==typeof(m=null===(c=t)||"object"!=typeof c?null:"function"==typeof(c=f&&c[f]||c["@@iterator"])?c:null))for(t=m.call(t),p=0;!(h=t.next()).done;)m=o+O(h=h.value,p++),d+=e(h,r,n,m,i);else if("object"===h)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(r=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return d}(e,n,"","",function(e){return t.call(r,e,o++)}),n}function I(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},P={transition:null};r.Children={map:_,forEach:function(e,t,r){_(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return _(e,function(){t++}),t},toArray:function(e){return _(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},r.Component=b,r.Fragment=n,r.Profiler=i,r.PureComponent=v,r.StrictMode=o,r.Suspense=h,r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:P,ReactCurrentOwner:k},r.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=y({},e.props),n=e.key,o=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,i=k.current),void 0!==t.key&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)R.call(t,u)&&!E.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}return{$$typeof:s,type:e.type,key:n,ref:o,props:a,_owner:i}},r.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},r.createElement=x,r.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},r.createRef=function(){return{current:null}},r.forwardRef=function(e){return{$$typeof:c,render:e}},r.isValidElement=A,r.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:I}},r.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},r.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},r.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},r.useCallback=function(e,t){return N.current.useCallback(e,t)},r.useContext=function(e){return N.current.useContext(e)},r.useDebugValue=function(){},r.useDeferredValue=function(e){return N.current.useDeferredValue(e)},r.useEffect=function(e,t){return N.current.useEffect(e,t)},r.useId=function(){return N.current.useId()},r.useImperativeHandle=function(e,t,r){return N.current.useImperativeHandle(e,t,r)},r.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},r.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},r.useMemo=function(e,t){return N.current.useMemo(e,t)},r.useReducer=function(e,t,r){return N.current.useReducer(e,t,r)},r.useRef=function(e){return N.current.useRef(e)},r.useState=function(e){return N.current.useState(e)},r.useSyncExternalStore=function(e,t,r){return N.current.useSyncExternalStore(e,t,r)},r.useTransition=function(){return N.current.useTransition()},r.version="18.2.0"},{}],cv0GT:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"useDomainWhitelist",()=>i),s.export(r,"useToggleWhitelistDomain",()=>l);var a=e("react"),n=e("~hooks/usePermission"),o=e("~utils/storage");function i(){let[e,t]=(0,o.useDomainStorage)(),r=(0,a.useCallback)(e=>{e&&t(t=>[...(t??[]).filter(t=>t!==e)])},[]),s=(0,a.useCallback)(e=>{e&&t(t=>[...(t??[]).filter(t=>t!==e),e])},[]);return{removeDomain:r,addDomain:s,domainWhitelist:e}}function l(e){let{domainWhitelist:t,addDomain:r,removeDomain:s}=i(),o=t.includes(e??""),{grantPermission:l}=(0,n.usePermission)(),u=(chrome||browser).runtime.getURL(o?"assets/active.png":"assets/inactive.png");(chrome||browser).action.setIcon({path:u});let c=(0,a.useCallback)(()=>{if(!o){r(e);return}s(e)},[o,e,r,s,l]);return{toggle:c,isWhitelisted:o}}},{react:"34kvN","~hooks/usePermission":"aUAKP","~utils/storage":"gy7md","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],gy7md:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"DEFAULT_DOMAIN_WHITELIST",()=>i),s.export(r,"storage",()=>l),s.export(r,"useDomainStorage",()=>h),s.export(r,"isDomainWhitelisted",()=>d),s.export(r,"assertDomainWhitelist",()=>p);var a=e("@plasmohq/storage"),n=e("@plasmohq/storage/hook"),o=e("~utils/domains");let i=["mw.lonelil.ru","watch.qtchaos.de","bmov.vercel.app","stream.thehairy.me","scootydooter.vercel.app","movie-web-me.vercel.app"],l=new a.Storage,u=async()=>{let e=await l.get("domainWhitelist");return e||await l.set("domainWhitelist",i),e??i},c=async e=>{let t=await u();return t?.some(t=>t.includes(e))??!1};function h(){return(0,n.useStorage)("domainWhitelist",e=>e??i)}let d=async e=>{if(!e)return!1;let t=(0,o.makeUrlIntoDomain)(e);return!!t&&c(t)},p=async e=>{let t=await d(e),r=(0,o.makeUrlIntoDomain)(e);if(!t)throw Error(`${r} is not whitelisted. Open the extension and click on the power button to whitelist the site.`)}},{"@plasmohq/storage":"cPZtE","@plasmohq/storage/hook":"5rBap","~utils/domains":"jOtHX","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],cPZtE:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"BaseStorage",()=>i),s.export(r,"Storage",()=>l);var a=e("pify"),n=s.interopDefault(a),o=()=>{try{let e=globalThis.navigator?.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===e[1])return 100>parseInt(e[2])||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{}return!1},i=class{#e;#t;get primaryClient(){return this.#t}#r;get secondaryClient(){return this.#r}#s;get area(){return this.#s}get hasWebApi(){try{return"u">typeof window&&!!window.localStorage}catch(e){return console.error(e),!1}}#a=new Map;#n;get copiedKeySet(){return this.#n}isCopied=e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e));#o=!1;get allCopied(){return this.#o}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=e=>e.startsWith(this.keyNamespace);getNamespacedKey=e=>`${this.keyNamespace}${e}`;getUnnamespacedKey=e=>e.slice(this.keyNamespace.length);constructor({area:e="sync",allCopied:t=!1,copiedKeyList:r=[]}={}){this.setCopiedKeySet(r),this.#s=e,this.#o=t;try{this.hasWebApi&&(t||r.length>0)&&(this.#r=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#e=this.getExtStorageApi(),o()?this.#t=(0,n.default)(this.#e[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#t=this.#e[this.area])}catch{}}setCopiedKeySet(e){this.#n=new Set(e)}rawGetAll=()=>this.#t?.get();getAll=async()=>Object.entries(await this.rawGetAll()).filter(([e])=>this.isValidKey(e)).reduce((e,[t,r])=>(e[this.getUnnamespacedKey(t)]=r,e),{});copy=async e=>{let t=void 0===e;if(!t&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let r=this.allCopied?await this.rawGetAll():await this.#t.get((t?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!r)return!1;let s=!1;for(let e in r){let t=r[e],a=this.#r?.getItem(e);this.#r?.setItem(e,t),s||=t!==a}return s};rawGet=async e=>this.hasExtensionApi?(await this.#t.get(e))[e]:this.isCopied(e)?this.#r?.getItem(e):null;rawSet=async(e,t)=>(this.isCopied(e)&&this.#r?.setItem(e,t),this.hasExtensionApi&&await this.#t.set({[e]:t}),null);clear=async(e=!1)=>{e&&this.#r?.clear(),await this.#t.clear()};rawRemove=async e=>{this.isCopied(e)&&this.#r?.removeItem(e),this.hasExtensionApi&&await this.#t.remove(e)};removeAll=async()=>{let e=Object.keys(await this.rawGetAll());await Promise.all(e.map(this.rawRemove))};watch=e=>{let t=this.isWatchSupported();return t&&this.#i(e),t};#i=e=>{for(let t in e){let r=this.getNamespacedKey(t),s=this.#a.get(r)?.callbackSet||new Set;if(s.add(e[t]),s.size>1)continue;let a=(e,t)=>{if(t!==this.area||!e[r])return;let s=this.#a.get(r);Promise.all([this.parseValue(e[r].newValue),this.parseValue(e[r].oldValue)]).then(([e,r])=>{for(let a of s.callbackSet)a({newValue:e,oldValue:r},t)})};this.#e.onChanged.addListener(a),this.#a.set(r,{callbackSet:s,listener:a})}};unwatch=e=>{let t=this.isWatchSupported();return t&&this.#l(e),t};#l(e){for(let t in e){let r=this.getNamespacedKey(t),s=e[t];if(this.#a.has(r)){let e=this.#a.get(r);e.callbackSet.delete(s),0===e.callbackSet.size&&(this.#a.delete(r),this.#e.onChanged.removeListener(e.listener))}}}unwatchAll=()=>this.#u();#u(){this.#a.forEach(({listener:e})=>this.#e.onChanged.removeListener(e)),this.#a.clear()}async getItem(e){return this.get(e)}async setItem(e,t){await this.set(e,t)}async removeItem(e){return this.remove(e)}},l=class extends i{get=async e=>{let t=this.getNamespacedKey(e),r=await this.rawGet(t);return this.parseValue(r)};set=async(e,t)=>{let r=this.getNamespacedKey(e),s=JSON.stringify(t);return this.rawSet(r,s)};remove=async e=>{let t=this.getNamespacedKey(e);return this.rawRemove(t)};setNamespace=e=>{this.keyNamespace=e};parseValue=async e=>{try{if(void 0!==e)return JSON.parse(e)}catch(e){console.error(e)}}}},{pify:"9arDK","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9arDK":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"default",()=>o);let a=(e,t,r,s)=>function(...a){let n=t.promiseModule;return new n((n,o)=>{t.multiArgs?a.push((...e)=>{t.errorFirst?e[0]?o(e):(e.shift(),n(e)):n(e)}):t.errorFirst?a.push((e,t)=>{e?o(e):n(t)}):a.push(n);let i=this===r?s:this;Reflect.apply(e,i,a)})},n=new WeakMap;function o(e,t){t={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...t};let r=typeof e;if(!(null!==e&&("object"===r||"function"===r)))throw TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===e?"null":r}\``);let s=(e,r)=>{let s=n.get(e);if(s||(s={},n.set(e,s)),r in s)return s[r];let a=e=>"string"==typeof e||"symbol"==typeof r?r===e:e.test(r),o=Reflect.getOwnPropertyDescriptor(e,r),i=void 0===o||o.writable||o.configurable,l=t.include?t.include.some(e=>a(e)):!t.exclude.some(e=>a(e)),u=l&&i;return s[r]=u,u},o=new WeakMap,i=new Proxy(e,{apply(e,r,s){let n=o.get(e);if(n)return Reflect.apply(n,r,s);let l=t.excludeMain?e:a(e,t,i,e);return o.set(e,l),Reflect.apply(l,r,s)},get(e,r){let n=e[r];if(!s(e,r)||n===Function.prototype[r])return n;let l=o.get(n);if(l)return l;if("function"==typeof n){let r=a(n,t,i,e);return o.set(n,r),r}return n}});return i}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],hbR2Q:[function(e,t,r){r.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},r.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.exportAll=function(e,t){return Object.keys(e).forEach(function(r){"default"===r||"__esModule"===r||t.hasOwnProperty(r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})}),t},r.export=function(e,t,r){Object.defineProperty(e,t,{enumerable:!0,get:r})}},{}],"5rBap":[function(e,t,r){var s,a=Object.create,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,c=(e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of i(t))u.call(e,a)||a===r||n(e,a,{get:()=>t[a],enumerable:!(s=o(t,a))||s.enumerable});return e},h={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(h,{useStorage:()=>g}),t.exports=c(n({},"__esModule",{value:!0}),h);var d=e("b1b2c5b56fa28750"),p=c(n(null!=(s=e("417435e93603adfd"))?a(l(s)):{},"default",{value:s,enumerable:!0}),s),f=()=>{try{let e=globalThis.navigator?.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===e[1])return 100>parseInt(e[2])||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{}return!1},m=class{#a;#t;get primaryClient(){return this.#t}#r;get secondaryClient(){return this.#r}#s;get area(){return this.#s}get hasWebApi(){try{return"u">typeof window&&!!window.localStorage}catch(e){return console.error(e),!1}}#e=new Map;#n;get copiedKeySet(){return this.#n}isCopied=e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e));#o=!1;get allCopied(){return this.#o}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=e=>e.startsWith(this.keyNamespace);getNamespacedKey=e=>`${this.keyNamespace}${e}`;getUnnamespacedKey=e=>e.slice(this.keyNamespace.length);constructor({area:e="sync",allCopied:t=!1,copiedKeyList:r=[]}={}){this.setCopiedKeySet(r),this.#s=e,this.#o=t;try{this.hasWebApi&&(t||r.length>0)&&(this.#r=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#a=this.getExtStorageApi(),f()?this.#t=(0,p.default)(this.#a[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#t=this.#a[this.area])}catch{}}setCopiedKeySet(e){this.#n=new Set(e)}rawGetAll=()=>this.#t?.get();getAll=async()=>Object.entries(await this.rawGetAll()).filter(([e])=>this.isValidKey(e)).reduce((e,[t,r])=>(e[this.getUnnamespacedKey(t)]=r,e),{});copy=async e=>{let t=void 0===e;if(!t&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let r=this.allCopied?await this.rawGetAll():await this.#t.get((t?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!r)return!1;let s=!1;for(let e in r){let t=r[e],a=this.#r?.getItem(e);this.#r?.setItem(e,t),s||=t!==a}return s};rawGet=async e=>this.hasExtensionApi?(await this.#t.get(e))[e]:this.isCopied(e)?this.#r?.getItem(e):null;rawSet=async(e,t)=>(this.isCopied(e)&&this.#r?.setItem(e,t),this.hasExtensionApi&&await this.#t.set({[e]:t}),null);clear=async(e=!1)=>{e&&this.#r?.clear(),await this.#t.clear()};rawRemove=async e=>{this.isCopied(e)&&this.#r?.removeItem(e),this.hasExtensionApi&&await this.#t.remove(e)};removeAll=async()=>{let e=Object.keys(await this.rawGetAll());await Promise.all(e.map(this.rawRemove))};watch=e=>{let t=this.isWatchSupported();return t&&this.#i(e),t};#i=e=>{for(let t in e){let r=this.getNamespacedKey(t),s=this.#e.get(r)?.callbackSet||new Set;if(s.add(e[t]),s.size>1)continue;let a=(e,t)=>{if(t!==this.area||!e[r])return;let s=this.#e.get(r);Promise.all([this.parseValue(e[r].newValue),this.parseValue(e[r].oldValue)]).then(([e,r])=>{for(let a of s.callbackSet)a({newValue:e,oldValue:r},t)})};this.#a.onChanged.addListener(a),this.#e.set(r,{callbackSet:s,listener:a})}};unwatch=e=>{let t=this.isWatchSupported();return t&&this.#l(e),t};#l(e){for(let t in e){let r=this.getNamespacedKey(t),s=e[t];if(this.#e.has(r)){let e=this.#e.get(r);e.callbackSet.delete(s),0===e.callbackSet.size&&(this.#e.delete(r),this.#a.onChanged.removeListener(e.listener))}}}unwatchAll=()=>this.#u();#u(){this.#e.forEach(({listener:e})=>this.#a.onChanged.removeListener(e)),this.#e.clear()}async getItem(e){return this.get(e)}async setItem(e,t){await this.set(e,t)}async removeItem(e){return this.remove(e)}},y=class extends m{get=async e=>{let t=this.getNamespacedKey(e),r=await this.rawGet(t);return this.parseValue(r)};set=async(e,t)=>{let r=this.getNamespacedKey(e),s=JSON.stringify(t);return this.rawSet(r,s)};remove=async e=>{let t=this.getNamespacedKey(e);return this.rawRemove(t)};setNamespace=e=>{this.keyNamespace=e};parseValue=async e=>{try{if(void 0!==e)return JSON.parse(e)}catch(e){console.error(e)}}},g=(e,t)=>{let r="object"==typeof e,s=r?e.key:e,[a,n]=(0,d.useState)(t),o=(0,d.useRef)(!1),i=(0,d.useRef)(t instanceof Function?t():t);(0,d.useEffect)(()=>{i.current=a},[a]);let l=(0,d.useRef)(r?e.instance:new y),u=(0,d.useCallback)(e=>l.current.set(s,void 0!==e?e:i.current),[s]),c=(0,d.useCallback)(async e=>{let t=e instanceof Function?e(i.current):e;await u(t),o.current&&n(t)},[u]);(0,d.useEffect)(()=>{o.current=!0;let e={[s]:e=>{o.current&&n(e.newValue)}};return l.current.watch(e),l.current.get(s)?.then(e=>{if(t instanceof Function){let r=t?.(e,!0);void 0!==r&&c(r)}else n(void 0!==e?e:t)}),()=>{o.current=!1,l.current.unwatch(e),t instanceof Function&&n(t)}},[s,c]);let h=(0,d.useCallback)(()=>{l.current.remove(s),n(void 0)},[s]);return[a,c,{setRenderValue:n,setStoreValue:u,remove:h}]}},{b1b2c5b56fa28750:"34kvN","417435e93603adfd":"9arDK"}],jOtHX:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");function a(e){try{let t=new URL(e);if(!["http:","https:"].includes(t.protocol))return null;return t.host.toLowerCase()}catch{return null}}s.defineInteropFlag(r),s.export(r,"makeUrlIntoDomain",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],cbs6b:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");function a(e){let t=e?.prefixed?"v":"",r=(chrome||browser).runtime.getManifest();return`${t}${r.version}`}function n(e){return a(e)}s.defineInteropFlag(r),s.export(r,"getVersion",()=>a),s.export(r,"useVersion",()=>n)},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],fZ9h9:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var s=e("~utils/declarativeNetRequest"),a=e("~utils/extension"),n=e("~utils/fetcher"),o=e("~utils/storage");let i=(e,t)=>{if("FormData"===t){let t=new FormData;e.forEach(([e,r])=>{t.append(e,r.toString())})}return"URLSearchParams"===t?new URLSearchParams(e):"object"===t?JSON.stringify(e):e},l=async(e,t)=>{try{if(!e.sender?.tab?.url)throw Error("No tab URL found in the request.");if(!e.body)throw Error("No request body found in the request.");let r=(0,n.makeFullUrl)(e.body.url,e.body);await (0,o.assertDomainWhitelist)(e.sender.tab.url),await (0,s.setDynamicRules)({ruleId:23498,targetDomains:[new URL(r).hostname],requestHeaders:e.body.headers});let l=await fetch(r,{method:e.body.method,headers:e.body.headers,body:i(e.body.body,e.body.bodyType)});await (0,s.removeDynamicRules)([23498]);let u=l.headers.get("content-type"),c=u?.includes("application/json")?await l.json():await l.text(),h=await (chrome||browser).cookies.getAll({url:l.url,...(0,a.isFirefox)()&&{firstPartyDomain:new URL(l.url).hostname}});t.send({success:!0,response:{statusCode:l.status,headers:{...Object.fromEntries(l.headers.entries()),"Set-Cookie":h.map(e=>`${e.name}=${e.value}`).join(", ")},body:c,finalUrl:l.url}})}catch(e){console.error("failed request",e),t.send({success:!1,error:e instanceof Error?e.message:String(e)})}};r.default=l},{"~utils/declarativeNetRequest":"b5jmb","~utils/extension":"9ArmX","~utils/fetcher":"OXXSb","~utils/storage":"gy7md","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],b5jmb:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"setDynamicRules",()=>o),s.export(r,"removeDynamicRules",()=>i);var a=e("./extension");let n=(e,t)=>Object.entries(e).map(([e,r])=>({header:e,operation:t,value:r})),o=async e=>{if((0,a.isChrome)()){if(await chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:[e.ruleId],addRules:[{id:e.ruleId,condition:{...e.targetDomains&&{requestDomains:e.targetDomains},...e.targetRegex&&{regexFilter:e.targetRegex}},action:{type:chrome.declarativeNetRequest.RuleActionType.MODIFY_HEADERS,...e.requestHeaders&&Object.keys(e.requestHeaders).length>0?{requestHeaders:n(e.requestHeaders,chrome.declarativeNetRequest.HeaderOperation.SET)}:{},responseHeaders:[{header:"Access-Control-Allow-Origin",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"*"},{header:"Access-Control-Allow-Methods",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"GET, POST, PUT, DELETE, PATCH, OPTIONS"},{header:"Access-Control-Allow-Headers",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"*"},{header:"Access-Control-Allow-Credentials",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"true"},...n(e.responseHeaders??{},chrome.declarativeNetRequest.HeaderOperation.SET)]}}]}),chrome.runtime.lastError?.message)throw Error(chrome.runtime.lastError.message)}else if(await browser.declarativeNetRequest.updateDynamicRules({removeRuleIds:[e.ruleId],addRules:[{id:e.ruleId,condition:{...e.targetDomains&&{requestDomains:e.targetDomains},...e.targetRegex&&{regexFilter:e.targetRegex}},action:{type:"modifyHeaders",...e.requestHeaders&&Object.keys(e.requestHeaders).length>0?{requestHeaders:n(e.requestHeaders,"set")}:{},responseHeaders:[{header:"Access-Control-Allow-Origin",operation:"set",value:"*"},{header:"Access-Control-Allow-Methods",operation:"set",value:"GET, POST, PUT, DELETE, PATCH, OPTIONS"},{header:"Access-Control-Allow-Headers",operation:"set",value:"*"},{header:"Access-Control-Allow-Credentials",operation:"set",value:"true"},...n(e.responseHeaders??{},"set")]}}]}),browser.runtime.lastError?.message)throw Error(browser.runtime.lastError.message)},i=async e=>{if(await (chrome||browser).declarativeNetRequest.updateDynamicRules({removeRuleIds:e}),(chrome||browser).runtime.lastError?.message)throw Error((chrome||browser).runtime.lastError?.message??"Unknown error")}},{"./extension":"9ArmX","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9ArmX":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"isChrome",()=>a),s.export(r,"isFirefox",()=>n);let a=()=>chrome.runtime.getURL("").startsWith("chrome-extension://"),n=()=>{try{return browser.runtime.getURL("").startsWith("moz-extension://")}catch{return!1}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],OXXSb:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");function a(e,t){let r=t?.baseUrl??"",s=e;r.length>0&&!r.endsWith("/")&&(r+="/"),s.startsWith("/")&&(s=s.slice(1));let a=r+s;if(!a.startsWith("http://")&&!a.startsWith("https://"))throw Error(`Invald URL -- URL doesn't start with a http scheme: '${a}'`);let n=new URL(a);return Object.entries(t?.query??{}).forEach(([e,t])=>{n.searchParams.set(e,t)}),n.toString()}s.defineInteropFlag(r),s.export(r,"makeFullUrl",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],ZIxra:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var s=e("~utils/extension");let a=async(e,t)=>{try{if(!e.sender?.tab?.id)throw Error("No tab ID found in the request.");if(!e.body)throw Error("No body found in the request.");let r=new URLSearchParams;r.set("redirectUrl",e.body.redirectUrl);let a=(chrome||browser).runtime.getURL(`/tabs/${e.body.page}.html?${r.toString()}`);(0,s.isChrome)()?await chrome.tabs.update(e.sender.tab.id,{url:a}):await browser.tabs.update(e.sender.tab.id,{url:a}),t.send({success:!0})}catch(e){t.send({success:!1,error:e instanceof Error?e.message:String(e)})}};r.default=a},{"~utils/extension":"9ArmX","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],amvG0:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var s=e("~utils/declarativeNetRequest"),a=e("~utils/storage");let n=async(e,t)=>{try{if(!e.sender?.tab?.url)throw Error("No tab URL found in the request.");if(!e.body)throw Error("No request body found in the request.");await (0,a.assertDomainWhitelist)(e.sender.tab.url),await (0,s.setDynamicRules)(e.body),t.send({success:!0})}catch(e){t.send({success:!1,error:e instanceof Error?e.message:String(e)})}};r.default=n},{"~utils/declarativeNetRequest":"b5jmb","~utils/storage":"gy7md","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],fx8Od:[function(e,t,r){(0,e("~utils/extension").isChrome)()?chrome.runtime.onStartup.addListener(()=>{chrome.runtime.reload()}):browser.runtime.onStartup.addListener(()=>{browser.runtime.reload()})},{"~utils/extension":"9ArmX"}]},["kgW6q"],"kgW6q","parcelRequire1a16"),globalThis.define=t;